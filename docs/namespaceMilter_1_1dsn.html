<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pymilter: Milter.dsn Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pymilter
   &#160;<span id="projectnumber">1.0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceMilter.html">Milter</a></li><li class="navelem"><a class="el" href="namespaceMilter_1_1dsn.html">dsn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Milter.dsn Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Support DSNs and CallBackValidations (CBV).  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMilter_1_1dsn_1_1Vars.html">Vars</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acbe09f59aaa4ca067189f08e9f2d38d6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceMilter_1_1dsn.html#acbe09f59aaa4ca067189f08e9f2d38d6">send_dsn</a> (mailfrom, receiver, msg=None, timeout=600, session=None, ourfrom='')</td></tr>
<tr class="memdesc:acbe09f59aaa4ca067189f08e9f2d38d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send DSN.  <a href="#acbe09f59aaa4ca067189f08e9f2d38d6">More...</a><br /></td></tr>
<tr class="separator:acbe09f59aaa4ca067189f08e9f2d38d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa713bf34ec804fe8dd24fb4aa7c83141"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceMilter_1_1dsn.html#aa713bf34ec804fe8dd24fb4aa7c83141">create_msg</a> (v, rcptlist=None, origmsg=None, template=None)</td></tr>
<tr class="separator:aa713bf34ec804fe8dd24fb4aa7c83141"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2776201312f8aa18d3e08e111e243e1c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><b>q</b></td></tr>
<tr class="separator:a2776201312f8aa18d3e08e111e243e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d40b2aed892ae45a5141afc0fc6dca"><td class="memItemLeft" align="right" valign="top"><a id="a82d40b2aed892ae45a5141afc0fc6dca"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>result</b></td></tr>
<tr class="separator:a82d40b2aed892ae45a5141afc0fc6dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243617d6c6c4af2994659efdf1a8dba7"><td class="memItemLeft" align="right" valign="top"><a id="a243617d6c6c4af2994659efdf1a8dba7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>perm_error</b></td></tr>
<tr class="separator:a243617d6c6c4af2994659efdf1a8dba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b771fd4a441cb97f868e51b1aec0632"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><b>msg</b></td></tr>
<tr class="separator:a3b771fd4a441cb97f868e51b1aec0632"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Support DSNs and CallBackValidations (CBV). </p>
<p>A Delivery Status Notification (bounce) is sent to the envelope sender (original MAIL FROM) with a null MAIL FROM (&lt;&gt;) to notify the original sender # of delays or problems with delivery. A Callback Validation starts the DSN process, but stops before issuing the DATA command. The purpose is to check whether the envelope recipient is accepted (and is therefore a valid email). The null MAIL FROM tells the remote MTA to never reply according to RFC2821 (but some braindead MTAs reply anyway, of course).</p>
<p>Milters should cache CBV results and should avoid sending DSNs unless the sender is authenticated somehow (e.g. SPF Pass). However, when email is quarantined, and is not known to be a forgery, sending a DSN is better than silently disappearing, and a DSN is better than sending a normal message as notification - because MAIL FROM signing schemes can reject bounces of forged emails. Whatever you do, don't copy those assinine commercial filters that send a normal message to notify you that some virus is forging your email.</p>
<p><b>DSNs should <em>only</em> be sent to MAIL FROM addresses.</b> Never send a DSN or use a null MAIL FROM with an email address obtained from anywhere else. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa713bf34ec804fe8dd24fb4aa7c83141"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa713bf34ec804fe8dd24fb4aa7c83141">&#9670;&nbsp;</a></span>create_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def Milter.dsn.create_msg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rcptlist</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origmsg</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>template</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a DSN message from a template.  Template must be '\n' separated.
   v - an object whose attributes are used for substitutions.  Must
     have sender and receiver attributes at a minimum.
   rcptlist - used to set v.rcpt if given
   origmsg - used to set v.subject and v.spf_result if given
   template - a '\n' separated string with python '%(name)s' substitutions.
</pre> 
</div>
</div>
<a id="acbe09f59aaa4ca067189f08e9f2d38d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbe09f59aaa4ca067189f08e9f2d38d6">&#9670;&nbsp;</a></span>send_dsn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def Milter.dsn.send_dsn </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mailfrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>receiver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>timeout</em> = <code>600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>session</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ourfrom</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send DSN. </p>
<p>Try the published MX names in order, rejecting obviously bogus entries (like <code>localhost</code>). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mailfrom</td><td>the original sender we are notifying or validating </td></tr>
    <tr><td class="paramname">receiver</td><td>the HELO name of the MTA we are sending the DSN on behalf of. Be sure to send from an IP that matches the HELO. </td></tr>
    <tr><td class="paramname">msg</td><td>the DSN message in RFC2822 format, or None for CBV. </td></tr>
    <tr><td class="paramname">timeout</td><td>total seconds to wait for a response from an MX </td></tr>
    <tr><td class="paramname">session</td><td><a class="el" href="classMilter_1_1dns_1_1Session.html">Milter.dns.Session</a> object from current incoming mail session to reuse its cache, or None to create a fresh one. </td></tr>
    <tr><td class="paramname">ourfrom</td><td>set to a valid email to send a normal notification from, or to validate emails not obtained from MAIL FROM. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None on success or (status_code,msg) on failure. <pre class="fragment">Send DSN.  If msg is None, do callback verification.
   Mailfrom is original sender we are sending DSN or CBV to.
   Receiver is the MTA sending the DSN.
   Return None for success or (code,msg) for failure.</pre> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3b771fd4a441cb97f868e51b1aec0632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b771fd4a441cb97f868e51b1aec0632">&#9670;&nbsp;</a></span>msg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def Milter.dsn.msg</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;=  create_msg(q,[<span class="stringliteral">&#39;charlie@example.com&#39;</span>],<span class="keywordtype">None</span>,</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  )</div></div><!-- fragment -->
</div>
</div>
<a id="a2776201312f8aa18d3e08e111e243e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2776201312f8aa18d3e08e111e243e1c">&#9670;&nbsp;</a></span>q</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Milter.dsn.q</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;=  spf.query(<span class="stringliteral">&#39;192.168.9.50&#39;</span>,</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  <span class="stringliteral">&#39;SRS0=pmeHL=RH==stuart@example.com&#39;</span>,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  <span class="stringliteral">&#39;red.example.com&#39;</span>,receiver=<span class="stringliteral">&#39;mail.example.com&#39;</span>)</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
